"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[4575],{64575:function(e,t,n){n.r(t),n.d(t,{registerFunctions:function(){return R}});var r=n(51366),o=(n(91957),n(58780)),i=n(19249),a=n(7182),s=n(94837),u=n(86727),l=n(20031),p=n(28105),c=n(39536),f=n(93968),d=n(53110),h=n(94466),y=n(99606),w=n(76512),g=n(29197),m=n(78755),v=n(70206),b=n(41268),Z=n(14685);let _=null;async function S(e,t){const r=new d.default({portal:e,id:t});return await r.load(),null===_&&(_=await n.e(1350).then(n.bind(n,41350))),await _.fetchKnowledgeGraph(r.url)}function j(e,t,n,r,o){if(null===e)return null;if((0,s.c)(e)||(0,s.b)(e))return e;if((0,s.k)(e))return e.toJSDate();if((0,s.k)(e))return e.toJSDate();if((0,s.m)(e))return e.toStorageFormat();if((0,s.n)(e))return e.toStorageString();if((0,s.v)(e)){const i={};for(const a of e.keys())i[a]=j(e.field(a),t,n,r,o),i[a]instanceof l.Z&&o.push({container:i,indexer:a});return i}if((0,s.o)(e)){const i=e.map((e=>j(e,t,n,r,o)));for(let e=0;e<i.length;e++)i[e]instanceof l.Z&&o.push({container:i,indexer:e});return i}if((0,s.p)(e)){if(e.spatialReference.isWGS84)return e;if(e.spatialReference.isWebMercator&&t)return(0,c.Sx)(e);if(!t||!n)return e;throw new a.aV(r,a.rH.WrongSpatialReference,null)}}function G(e,t){if(!e)return null;const n={};for(const r in e)n[r]=x(e[r],t);return n}function x(e,t){return null===e?null:(0,s.o)(e)?e.map((e=>x(e,t))):e instanceof y.Z?{graphTypeName:e.typeName,id:e.id,graphType:"entity",properties:G(e.properties,t)}:e instanceof g.Z?{graphType:"object",properties:G(e.properties,t)}:e instanceof v.Z?{graphTypeName:e.typeName,id:e.id,graphType:"relationship",originId:e.originId??null,destinationId:e.destinationId??null,properties:G(e.properties,t)}:e instanceof m.Z?{graphType:"path",path:e.path?e.path.map((e=>x(e,t))):null}:(0,s.p)(e)?function(e,t){if(!e)return e;if(e.spatialReference.isWGS84&&t.spatialReference.isWebMercator)return(0,c.$)(e);if(e.spatialReference.equals(t.spatialReference))return e;throw new a.aV(t,a.rH.WrongSpatialReference,null)}(e,t):(0,s.c)(e)||(0,s.b)(e)||(0,s.a7)(e)?e:null}function R(e){"async"===e.mode&&(e.functions.knowledgegraphbyportalitem=function(t,n){return e.standardFunctionAsync(t,n,((e,r,i)=>{if((0,s.H)(i,2,2,t,n),null===i[0])throw new a.aV(t,a.rH.PortalRequired,n);if(i[0]instanceof o.Z){const e=(0,s.j)(i[1]);let n=null;return n=t.services?.portal?t.services.portal:f.Z.getDefault(),S((0,u._)(i[0],n),e)}if(!1===(0,s.c)(i[0]))throw new a.aV(t,a.rH.InvalidParameter,n);const l=(0,s.j)(i[0]);return S(t.services?.portal??f.Z.getDefault(),l)}))},e.signatures.push({name:"knowledgegraphbyportalitem",min:2,max:2}),e.functions.querygraph=function(t,o){return e.standardFunctionAsync(t,o,(async(e,u,l)=>{(0,s.H)(l,2,4,t,o);const c=l[0];if(!(0,s.w)(c))throw new a.aV(t,a.rH.InvalidParameter,o);const f=l[1];if(!(0,s.c)(f))throw new a.aV(t,a.rH.InvalidParameter,o);null===_&&(_=await n.e(1350).then(n.bind(n,41350)));let d=null;const y=(0,s.K)(l[2],null);if(!(y instanceof i.Z||null===y))throw new a.aV(t,a.rH.InvalidParameter,o);if(y){let e=[];d=j(y,!0,!1,t,e),e=e.filter((e=>!e.container[e.indexer].spatialReference.isWGS84)),e.length>0&&await async function(e){const t=r.default.geometryServiceUrl??"";if(!t){(0,p.isLoaded)()||await(0,p.load)();for(const t of e)t.container[t.indexer]=(0,p.project)(t.container[t.indexer],Z.Z.WGS84);return}const n=e.map((e=>e.container[e.indexer])),o=new b.Z({geometries:n,outSpatialReference:Z.Z.WGS84}),i=await(0,h.i)(t,o);for(let t=0;t<i.length;t++){const n=e[t];n.container[n.indexer]=i[t]}}(e)}const g=new w.Z({openCypherQuery:f,bindParameters:d});(c?.serviceDefinition?.currentVersion??11.3)>11.2&&(g.outputSpatialReference=t.spatialReference);const m=(await _.executeQueryStreaming(c,g)).resultRowsStream.getReader(),v=[];try{for(;;){const{done:e,value:n}=await m.read();if(e)break;if((0,s.o)(n))for(const e of n)v.push(x(e,t));else{const e=[];for(const r of n)e.push(x(n[r],t));v.push(e)}}}catch(e){throw e}return i.Z.convertJsonToArcade(v,(0,s.N)(t),!1,!0)}))},e.signatures.push({name:"querygraph",min:2,max:4}))}},86727:function(e,t,n){n.d(t,{_:function(){return o}});var r=n(93968);function o(e,t){return null===e?t:new r.Z({url:e.field("url")})}},99606:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(36663),o=(n(91957),n(81977)),i=(n(39994),n(13802),n(4157),n(40266)),a=n(63055),s=n(67666);let u=class extends a.Z{constructor(e){super(e),this.layoutGeometry=null}};(0,r._)([(0,o.Cb)({type:s.Z,json:{write:!0}})],u.prototype,"layoutGeometry",void 0),u=(0,r._)([(0,i.j)("esri.rest.knowledgeGraph.Entity")],u);const l=u},63055:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(36663),o=n(81977),i=(n(39994),n(13802),n(4157),n(40266)),a=n(60915);let s=class extends a.Z{constructor(e){super(e),this.typeName=null,this.id=null}};(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],s.prototype,"typeName",void 0),(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],s.prototype,"id",void 0),s=(0,r._)([(0,i.j)("esri.rest.knowledgeGraph.GraphNamedObject")],s);const u=s},60915:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(36663),o=n(82064),i=n(81977),a=(n(39994),n(13802),n(4157),n(40266));let s=class extends o.wq{constructor(e){super(e),this.properties=null}};(0,r._)([(0,i.Cb)({json:{write:!0}})],s.prototype,"properties",void 0),s=(0,r._)([(0,a.j)("esri.rest.knowledgeGraph.GraphObject")],s);const u=s},76512:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(36663),o=n(81977),i=(n(39994),n(13802),n(4157),n(40266)),a=n(74396);let s=class extends a.Z{constructor(e){super(e),this.openCypherQuery=""}};(0,r._)([(0,o.Cb)()],s.prototype,"openCypherQuery",void 0),s=(0,r._)([(0,i.j)("esri.rest.knowledgeGraph.GraphQuery")],s);const u=s;let l=class extends u{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null}};(0,r._)([(0,o.Cb)()],l.prototype,"bindParameters",void 0),(0,r._)([(0,o.Cb)()],l.prototype,"bindGeometryQuantizationParameters",void 0),(0,r._)([(0,o.Cb)()],l.prototype,"outputQuantizationParameters",void 0),(0,r._)([(0,o.Cb)()],l.prototype,"outputSpatialReference",void 0),l=(0,r._)([(0,i.j)("esri.rest.knowledgeGraph.GraphQueryStreaming")],l);const p=l},29197:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(36663),o=(n(13802),n(39994),n(4157),n(70375),n(40266)),i=n(60915);let a=class extends i.Z{constructor(e){super(e)}};a=(0,r._)([(0,o.j)("esri.rest.knowledgeGraph.ObjectValue")],a);const s=a},78755:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(36663),o=n(82064),i=n(81977),a=(n(39994),n(13802),n(4157),n(40266)),s=n(60915);let u=class extends o.wq{constructor(e){super(e),this.path=null}};(0,r._)([(0,i.Cb)({type:[s.Z],json:{write:!0}})],u.prototype,"path",void 0),u=(0,r._)([(0,a.j)("esri.rest.knowledgeGraph.Path")],u);const l=u},70206:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(36663),o=(n(91957),n(81977)),i=(n(39994),n(13802),n(4157),n(40266)),a=n(63055),s=n(90819);let u=class extends a.Z{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"originId",void 0),(0,r._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"destinationId",void 0),(0,r._)([(0,o.Cb)({type:s.Z,json:{write:!0}})],u.prototype,"layoutGeometry",void 0),u=(0,r._)([(0,i.j)("esri.rest.Relationship.Relationship")],u);const l=u}}]);